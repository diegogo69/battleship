(()=>{"use strict";var n={56:(n,e,t)=>{n.exports=function(n){var e=t.nc;e&&n.setAttribute("nonce",e)}},72:n=>{var e=[];function t(n){for(var t=-1,r=0;r<e.length;r++)if(e[r].identifier===n){t=r;break}return t}function r(n,r){for(var a={},i=[],s=0;s<n.length;s++){var l=n[s],d=r.base?l[0]+r.base:l[0],c=a[d]||0,p="".concat(d," ").concat(c);a[d]=c+1;var u=t(p),h={css:l[1],media:l[2],sourceMap:l[3],supports:l[4],layer:l[5]};if(-1!==u)e[u].references++,e[u].updater(h);else{var m=o(h,r);r.byIndex=s,e.splice(s,0,{identifier:p,updater:m,references:1})}i.push(p)}return i}function o(n,e){var t=e.domAPI(e);return t.update(n),function(e){if(e){if(e.css===n.css&&e.media===n.media&&e.sourceMap===n.sourceMap&&e.supports===n.supports&&e.layer===n.layer)return;t.update(n=e)}else t.remove()}}n.exports=function(n,o){var a=r(n=n||[],o=o||{});return function(n){n=n||[];for(var i=0;i<a.length;i++){var s=t(a[i]);e[s].references--}for(var l=r(n,o),d=0;d<a.length;d++){var c=t(a[d]);0===e[c].references&&(e[c].updater(),e.splice(c,1))}a=l}}},113:n=>{n.exports=function(n,e){if(e.styleSheet)e.styleSheet.cssText=n;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(n))}}},158:(n,e,t)=>{t.d(e,{A:()=>s});var r=t(601),o=t.n(r),a=t(314),i=t.n(a)()(o());i.push([n.id,"\n.gameboard {\n    position: relative;\n    display: flex;\n    flex-direction: column;\n    width: 100%;\n    height: 100%;\n    box-sizing: content-box;\n    border: 1px solid var(--grid-border);\n}\n\n.gameboard-row {\n    display: flex;\n}\n\n.gameboard-col {\n    position: relative;\n    width: 34px;\n    height: 34px;\n    border: 1px solid var(--grid-border);\n}\n\n.ship {\n    display: flex;\n    max-width: max-content;\n    background-color: var(--ship-bg);\n    cursor: grab;\n    /* Align to gameboard grid */\n    border-right: 2px solid var(--ship-border);\n    border-bottom: 2px solid var(--ship-border);\n}\n\n/* HORIZONTAL SHIPS BORDER */\n.ship.flex-row .ship-cell {\n    border-top: 2px solid var(--ship-border);\n    border-left: 2px solid var(--ship-border);\n}\n\n/* VERTICAL SHIPS BORDER */\n.ship.flex-col .ship-cell {\n    border-top: 2px solid var(--ship-border);\n    border-left: 2px solid var(--ship-border);\n}\n\n.ship-cell {\n    position: relative;\n    width: 34px;\n    height: 34px;\n}\n\n.flex-row {\n    flex-direction: row;\n}\n\n.flex-col {\n    flex-direction: column;\n}\n\n.isMiss {\n    z-index: 1;\n    outline: 1px solid var(--miss-border);\n    border: 1px solid var(--miss-border);\n    background-color: var(--ship-miss);\n}\n\n.hasShip {\n    z-index: 2;\n    outline: 1px solid var(--ship-border);\n    border: 1px solid var(--ship-border);\n    background-color: var(--ship-bg);\n}\n\n.isHit {\n    z-index: 3;\n    outline: 1px solid  var(--ship-hit-border);\n    border: 1px solid var(--ship-hit-border);\n    background-color: var(--ship-hit);\n}\n\n.positioned {\n    z-index: 1;\n    position: absolute;\n    top: -2px;\n    left: -2px;\n}\n\n.gameboard-col.hovered {\n    background-color: yellow;\n}\n\n.ship.dragging {\n    opacity: 1;\n}\n\n.cell.invalid-drop {\n    background-color: red;\n}\n\n.invalid-cell {\n    cursor: not-allowed;\n}\n\n.gameboard > .player-board-span {\n    position: absolute;\n    /* text-align: center; */\n    top: -2.2rem;\n    left: 1px;\n    display: flex;\n    gap: 1rem;\n    align-items: center;\n    width: 340px;\n}\n\n.gameboard > .player-board-span > div {\n    width: 15px;\n    height: 15px;\n}\n\n.being-attacked {\n    box-shadow: 0px 0px 15px 2px var(--red-shadow);\n    cursor: crosshair;\n}",""]);const s=i},314:n=>{n.exports=function(n){var e=[];return e.toString=function(){return this.map((function(e){var t="",r=void 0!==e[5];return e[4]&&(t+="@supports (".concat(e[4],") {")),e[2]&&(t+="@media ".concat(e[2]," {")),r&&(t+="@layer".concat(e[5].length>0?" ".concat(e[5]):""," {")),t+=n(e),r&&(t+="}"),e[2]&&(t+="}"),e[4]&&(t+="}"),t})).join("")},e.i=function(n,t,r,o,a){"string"==typeof n&&(n=[[null,n,void 0]]);var i={};if(r)for(var s=0;s<this.length;s++){var l=this[s][0];null!=l&&(i[l]=!0)}for(var d=0;d<n.length;d++){var c=[].concat(n[d]);r&&i[c[0]]||(void 0!==a&&(void 0===c[5]||(c[1]="@layer".concat(c[5].length>0?" ".concat(c[5]):""," {").concat(c[1],"}")),c[5]=a),t&&(c[2]?(c[1]="@media ".concat(c[2]," {").concat(c[1],"}"),c[2]=t):c[2]=t),o&&(c[4]?(c[1]="@supports (".concat(c[4],") {").concat(c[1],"}"),c[4]=o):c[4]="".concat(o)),e.push(c))}},e}},320:(n,e,t)=>{t.d(e,{A:()=>s});var r=t(601),o=t.n(r),a=t(314),i=t.n(a)()(o());i.push([n.id,"* {\n    margin: 0;\n    padding: 0;\n}\n\nsvg {\n    width: 24px;\n}\n\nbody {\n    --green-bg: #34d399;\n    --green-border: #10b981;\n    --blue-bg: #0ea5e9;\n    --blue-border: #2563eb;\n    --red-bg: #f43f5e;\n    --red-border: #be123c;\n    --shadow: #f1f5f9;\n    --red-shadow: #fb7185;\n    --grid-border: #ddd6fe;\n    --ship-bg: hsl(201, 96%, 80%);\n    --ship-border: hsl(188, 88%, 46%);\n    --ship-hit: #fb7185;\n    --ship-miss: hsl(60, 96%, 85%);\n    --miss-border: hsl(60, 46%, 75%);\n    --ship-hit-border: hsl(345, 83%, 46%);\n    \n    height: 100vh;\n    display: flex;\n    flex-direction: column;\n    user-select: none;\n    color: #262626;\n}\n\nbody > header {\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    height: 5;\n    padding: .6rem 2rem;\n    border: 2px solid var(--shadow)\n}\n\nh1 > span:first-child {\n    color: var(--red-bg)\n}\n\nh1 > span:last-child {\n    color: var(--blue-bg)\n}\n\nbody > main {\n    flex: 1;\n    display: flex;\n    padding: 0 2rem;\n}\n\nbody > footer {\n    height: 4rem;\n    display: grid;\n    place-content: center;\n    padding: 1.2rem 2rem 1rem;\n}\n\nbody > header > h1 {\n    font-size: 1.6rem;\n}\n.game-container {\n    flex: 1;\n    display: flex;\n    flex-direction: column;\n}\n\n.boards-header {\n    display: grid;\n    place-content: center;\n}\n\n.boards-header h2{\n    font-size: 1.3rem;\n}\n\n.boards-container {\n    flex: 1;\n    display: flex;\n    flex-wrap: wrap;\n    justify-content: center;\n    align-items: center;\n    gap: 2.8rem;\n    padding: 2rem 0;\n}\n\n.boards-footer {\n    display: grid;\n    justify-content: center;\n    gap: 0.9rem;\n    text-align: center;\n}\n\n.footer-text {\n    height: 2rem;\n    display: flex;\n    justify-content: center;\n    gap: 2rem;\n    font-weight: 900;\n}\n\n.footer-text > div {\n    display: flex;\n    gap: .4rem;\n    align-items: center;\n}\n\n.boards-btns {\n    display: flex;\n    justify-content: center;\n    gap: 1rem;\n}\n\n.boards-container > div {\n    min-width: 340px;\n    min-height: 340px;\n}\n\n.player1-container,\n.player2-container {\n    box-shadow: 1px 1px 8px 3px var(--shadow);\n    display: flex;\n}\n\n.ships-btns button {\n    width: 5.2rem;\n    height: 2.1rem;\n}\n\n.place-ships-wrapper {\n    flex: 1;\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    justify-items: center;\n    padding: .8rem;\n}\n\n.ships-container {\n    flex: 1;\n    display: flex;\n    flex-direction: column;\n    flex-wrap: wrap;\n    gap: .8rem;\n    justify-self: start;\n    align-self: start;\n}\n\n.place-ships-wrapper .ships-btns {\n    height: max-content;\n    padding: .8rem 0 0 0;\n    display: flex;\n    gap: .8rem;\n}\n\n.passScreen {\n    z-index: 4;\n    position: absolute;\n    top: -1px;\n    left: -1px;\n    width: 100%;\n    height: 100%;\n    display: grid;\n    place-content: center;\n    box-sizing: content-box;\n    border: 1px solid var(--grid-border);\n    background-color: hsla(0, 0%, 100%, 0.9);\n    backdrop-filter: blur(1px);\n\n}\n\n.passScreen > h3 {\n    font-size: 1.6rem;\n    padding: .8rem 0;\n\n}\n\ndialog button,\n.passScreen > button,\n.boards-btns button,\n.place-ships-wrapper button {\n    color: white;\n    font-weight: 900;\n    border-radius: .2rem;\n    cursor: pointer;\n}\n\n.passScreen > button,\n.place-ships-wrapper button.done-btn {\n    background-color:var(--green-bg);\n    border: 3px solid var(--green-border);\n}\n\ndialog button,\n.boards-btns button,\n.place-ships-wrapper button.random-btn {\n    background-color:var(--blue-bg);\n    border: 3px solid var(--blue-border);\n}\n\n.boards-btns button.new-pvp-btn {\n    background-color: var(--red-bg);\n    border: 3px solid var(--red-border);\n}\n\n.boards-btns > button {\n    padding: .4rem 1rem;\n    border-radius: 1rem;\n}\n\n.passScreen > button {\n    padding: .3rem 1rem;\n    border-radius: .2rem;\n    font-size: 1.3rem;\n}\n\n.cell-type {\n    width: 20px;\n    height: 20px;\n}\n\ndialog {\n    margin: auto;\n    display: grid;\n    justify-items: center;\n    place-content: center;\n    gap: 1.4rem;\n    border: 5px solid var(--blue-bg);\n    background-color: white;\n\n    padding: 4rem 6rem;\n    border-radius: 1rem;\n    user-select: none;\n    ;\n}\n\ndialog::backdrop {\n    background-color: hwb(0 100% 0% / 0.1);\n    backdrop-filter: blur(2px);\n}\ndialog button {\n    color:white;\n    font-size: 1.1rem;\n    padding: .4rem 2rem;\n    border-radius: 1rem;\n    ;\n}",""]);const s=i},433:(n,e,t)=>{t.d(e,{A:()=>s});var r=t(601),o=t.n(r),a=t(314),i=t.n(a)()(o());i.push([n.id,"/*! modern-normalize v3.0.0 | MIT License | https://github.com/sindresorhus/modern-normalize */\n\n/*\nDocument\n========\n*/\n\n/**\nUse a better box model (opinionated).\n*/\n\n*,\n::before,\n::after {\n\tbox-sizing: border-box;\n}\n\nhtml {\n\t/* Improve consistency of default fonts in all browsers. (https://github.com/sindresorhus/modern-normalize/issues/3) */\n\tfont-family:\n\t\tsystem-ui,\n\t\t'Segoe UI',\n\t\tRoboto,\n\t\tHelvetica,\n\t\tArial,\n\t\tsans-serif,\n\t\t'Apple Color Emoji',\n\t\t'Segoe UI Emoji';\n\tline-height: 1.5; /* 1. Correct the line height in all browsers. */\n\t-webkit-text-size-adjust: 100%; /* 2. Prevent adjustments of font size after orientation changes in iOS. */\n\ttab-size: 4; /* 3. Use a more readable tab size (opinionated). */\n}\n\n/*\nSections\n========\n*/\n\nbody {\n\tmargin: 0; /* Remove the margin in all browsers. */\n}\n\n/*\nText-level semantics\n====================\n*/\n\n/**\nAdd the correct font weight in Chrome and Safari.\n*/\n\nb,\nstrong {\n\tfont-weight: bolder;\n}\n\n/**\n1. Improve consistency of default fonts in all browsers. (https://github.com/sindresorhus/modern-normalize/issues/3)\n2. Correct the odd 'em' font sizing in all browsers.\n*/\n\ncode,\nkbd,\nsamp,\npre {\n\tfont-family:\n\t\tui-monospace,\n\t\tSFMono-Regular,\n\t\tConsolas,\n\t\t'Liberation Mono',\n\t\tMenlo,\n\t\tmonospace; /* 1 */\n\tfont-size: 1em; /* 2 */\n}\n\n/**\nAdd the correct font size in all browsers.\n*/\n\nsmall {\n\tfont-size: 80%;\n}\n\n/**\nPrevent 'sub' and 'sup' elements from affecting the line height in all browsers.\n*/\n\nsub,\nsup {\n\tfont-size: 75%;\n\tline-height: 0;\n\tposition: relative;\n\tvertical-align: baseline;\n}\n\nsub {\n\tbottom: -0.25em;\n}\n\nsup {\n\ttop: -0.5em;\n}\n\n/*\nTabular data\n============\n*/\n\n/**\nCorrect table border color inheritance in Chrome and Safari. (https://issues.chromium.org/issues/40615503, https://bugs.webkit.org/show_bug.cgi?id=195016)\n*/\n\ntable {\n\tborder-color: currentcolor;\n}\n\n/*\nForms\n=====\n*/\n\n/**\n1. Change the font styles in all browsers.\n2. Remove the margin in Firefox and Safari.\n*/\n\nbutton,\ninput,\noptgroup,\nselect,\ntextarea {\n\tfont-family: inherit; /* 1 */\n\tfont-size: 100%; /* 1 */\n\tline-height: 1.5; /* 1 */\n\tmargin: 0; /* 2 */\n}\n\n/**\nCorrect the inability to style clickable types in iOS and Safari.\n*/\n\nbutton,\n[type='button'],\n[type='reset'],\n[type='submit'] {\n\t-webkit-appearance: button;\n}\n\n/**\nRemove the padding so developers are not caught out when they zero out 'fieldset' elements in all browsers.\n*/\n\nlegend {\n\tpadding: 0;\n}\n\n/**\nAdd the correct vertical alignment in Chrome and Firefox.\n*/\n\nprogress {\n\tvertical-align: baseline;\n}\n\n/**\nCorrect the cursor style of increment and decrement buttons in Safari.\n*/\n\n::-webkit-inner-spin-button,\n::-webkit-outer-spin-button {\n\theight: auto;\n}\n\n/**\n1. Correct the odd appearance in Chrome and Safari.\n2. Correct the outline style in Safari.\n*/\n\n[type='search'] {\n\t-webkit-appearance: textfield; /* 1 */\n\toutline-offset: -2px; /* 2 */\n}\n\n/**\nRemove the inner padding in Chrome and Safari on macOS.\n*/\n\n::-webkit-search-decoration {\n\t-webkit-appearance: none;\n}\n\n/**\n1. Correct the inability to style clickable types in iOS and Safari.\n2. Change font properties to 'inherit' in Safari.\n*/\n\n::-webkit-file-upload-button {\n\t-webkit-appearance: button; /* 1 */\n\tfont: inherit; /* 2 */\n}\n\n/*\nInteractive\n===========\n*/\n\n/*\nAdd the correct display in Chrome and Safari.\n*/\n\nsummary {\n\tdisplay: list-item;\n}",""]);const s=i},540:n=>{n.exports=function(n){var e=document.createElement("style");return n.setAttributes(e,n.attributes),n.insert(e,n.options),e}},601:n=>{n.exports=function(n){return n[1]}},659:n=>{var e={};n.exports=function(n,t){var r=function(n){if(void 0===e[n]){var t=document.querySelector(n);if(window.HTMLIFrameElement&&t instanceof window.HTMLIFrameElement)try{t=t.contentDocument.head}catch(n){t=null}e[n]=t}return e[n]}(n);if(!r)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");r.appendChild(t)}},825:n=>{n.exports=function(n){if("undefined"==typeof document)return{update:function(){},remove:function(){}};var e=n.insertStyleElement(n);return{update:function(t){!function(n,e,t){var r="";t.supports&&(r+="@supports (".concat(t.supports,") {")),t.media&&(r+="@media ".concat(t.media," {"));var o=void 0!==t.layer;o&&(r+="@layer".concat(t.layer.length>0?" ".concat(t.layer):""," {")),r+=t.css,o&&(r+="}"),t.media&&(r+="}"),t.supports&&(r+="}");var a=t.sourceMap;a&&"undefined"!=typeof btoa&&(r+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(a))))," */")),e.styleTagTransform(r,n,e.options)}(e,n,t)},remove:function(){!function(n){if(null===n.parentNode)return!1;n.parentNode.removeChild(n)}(e)}}}}},e={};function t(r){var o=e[r];if(void 0!==o)return o.exports;var a=e[r]={id:r,exports:{}};return n[r](a,a.exports,t),a.exports}t.n=n=>{var e=n&&n.__esModule?()=>n.default:()=>n;return t.d(e,{a:e}),e},t.d=(n,e)=>{for(var r in e)t.o(e,r)&&!t.o(n,r)&&Object.defineProperty(n,r,{enumerable:!0,get:e[r]})},t.o=(n,e)=>Object.prototype.hasOwnProperty.call(n,e),t.nc=void 0;var r=t(72),o=t.n(r),a=t(825),i=t.n(a),s=t(659),l=t.n(s),d=t(56),c=t.n(d),p=t(540),u=t.n(p),h=t(113),m=t.n(h),f=t(433),g={};g.styleTagTransform=m(),g.setAttributes=c(),g.insert=l().bind(null,"head"),g.domAPI=i(),g.insertStyleElement=u(),o()(f.A,g),f.A&&f.A.locals&&f.A.locals;var b=t(320),v={};v.styleTagTransform=m(),v.setAttributes=c(),v.insert=l().bind(null,"head"),v.domAPI=i(),v.insertStyleElement=u(),o()(b.A,v),b.A&&b.A.locals&&b.A.locals;var y=t(158),x={};x.styleTagTransform=m(),x.setAttributes=c(),x.insert=l().bind(null,"head"),x.domAPI=i(),x.insertStyleElement=u(),o()(y.A,x),y.A&&y.A.locals&&y.A.locals;const w=function(){const n={main:document.querySelector("main"),boardsHeader:null,gameContainer:null,boardsContainer:null,btnWrapper:null,newPvPBtn:null,newPvCBtn:null,goBackBtn:null,footer:null,footerText:null,player:{1:null,2:null}},e={gamemodes(e,t){n.newPvCBtn.addEventListener("click",(()=>{e(!1)})),n.newPvPBtn.addEventListener("click",(()=>{e(!0)}))},goBack(e){n.goBackBtn=n.footer.querySelector(".go-back-btn"),n.goBackBtn.addEventListener("click",e)}},t={node(n,e,t){n.removeEventListener(e,t)},1:function(n,e){this.node(player1Container.firstChild,n,e)},2:function(n,e){this.node(player2Container.firstChild,n,e)}},r={node(n){for(;n.firstChild;)n.removeChild(n.firstChild)},player:{1:function(){r.node(n.player[1])},2:function(){r.node(n.player[2])}}},o={mainPage(e){r.node(n.main),n.main.appendChild(e)},boardsHeader(e){r.node(n.boardsHeader),n.boardsHeader.appendChild(e)},footer(e){n.gameContainer.removeChild(n.footer),n.gameContainer.appendChild(e),n.footer=e},board:{1:function(e){r.player[1](),n.player[1].appendChild(e)},2:function(e){r.player[2](),n.player[2].appendChild(e)}},ships(e,t){r.player[t](),n.player[t].appendChild(e)},dialog(n){document.body.appendChild(n),n.showModal()}};return{clear:r,render:o,removeEventListener:t,initHandlers:e,referenceDom:function(){n.gameContainer=n.main.querySelector(".game-container"),n.boardsHeader=n.gameContainer.querySelector(".boards-header"),n.boardsContainer=n.gameContainer.querySelector(".boards-container"),n.player[1]=n.boardsContainer.querySelector(".player1-container"),n.player[2]=n.boardsContainer.querySelector(".player2-container"),n.footer=n.main.querySelector("footer"),n.footerText=n.footer.querySelector("p"),n.btnWrapper=n.footer.querySelector(".boards-btns"),n.newPvPBtn=n.btnWrapper.querySelector(".new-pvp-btn"),n.newPvCBtn=n.btnWrapper.querySelector(".new-pvc-btn")}}}(),C=function(){let n=null,e=null,t=null,r=null,o=null,a=null,i=null;const s=function(n){if(!1!==i)return;if(n.currentTarget.closest(".place-ships-wrapper").querySelector(".ships-container").firstChild)return;const e=a.getTurn();console.log("Done fn");const t=document.querySelector(`#gameboard-${e}`);console.log(t);const r=function(n){const e=[];for(const t of n.children)for(const n of t.children)if(n.firstChild&&n.firstChild.classList.contains("ship")){console.log(n);const t=n.firstChild;e.push({rowcol:n.dataset.rowcol,length:parseInt(t.dataset.length),orientation:"horizontal"===t.dataset.orientation})}return e}(t);if(console.log(r),r.forEach((n=>{a.players[e].gameboard.placeShip(n.rowcol,n.length,n.orientation),console.log(n)})),console.log(a.isPvPGamemode()),1==a.isPvPGamemode()){if(1===e){a.changeTurn();const n=a.getTurn();return B.displayHeader(n,a.isPvPGamemode(),null,!0),B.displayBoard(n),void B.displayShips(s,n)}a.changeTurn()}p(),d(),i=!0,B.displayHeader(a.getTurn(),a.isPvPGamemode(),null,!1),B.displayBoards()},l=function(n){c(),B.displayWinner(n,a.isPvPGamemode()),B.displayHeader(a.getTurn(),a.isPvPGamemode(),n,!1)},d=function(){n=n=>{if(!n.target.dataset.rowcol)return;if(a.getTurn()==n.currentTarget.dataset.boardNo)return void console.log("Ignored, player click in its own board");const e=o(n);if(null!==e){if(!a.isPvPGamemode()&&2===a.getTurn()&&!0===e){let n=null,e=!0;for(;1==e;){if(n=a.checkWinner(),n){l(n);break}e=a.playAITurn()}return a.changeTurn(),void B.displayBoards()}if(!0===e){const n=a.checkWinner();return null!==n&&l(n),void B.displayBoards()}if(a.isPvPGamemode()&&!1===e)return B.displayHeader(a.getTurn(),a.isPvPGamemode(),null,!1),void B.displayPassScreen();!1===e&&B.displayBoards()}}},c=function(){n=null},p=function(){t=null,e=null,r=null};return{boardNode:function(o,s=!1,l=null){let d;d=null!==l?l:a.players[o].gameboard;const c=document.createElement("div");c.id=`gameboard-${o}`,c.classList.add("gameboard"),c.dataset.boardNo=o;const p=null!==l,u=p?o:a.getTurn();!p&&a.checkWinner()||o===u||c.classList.add("being-attacked");const h=d.shipsBoard,m=d.shotsBoard;if(h.forEach((function(n,a){const i=document.createElement("div");i.classList.add("gameboard-row"),h[a].forEach((function(n,l){const c=document.createElement("div");c.classList.add("gameboard-col"),c.dataset.rowcol=`${a}${l}`,p||!1!==s||o!==u||(null!==h[a][l]&&c.classList.add("hasShip"),t&&c.addEventListener("drop",(n=>{t(n,d)})),e&&c.addEventListener("dragover",e),r&&c.addEventListener("dragleave",r)),!1===m[a][l]&&c.classList.add("isMiss"),!0===m[a][l]&&c.classList.add("isHit"),i.appendChild(c)})),c.appendChild(i)})),!p&&!0===s&&o!==u){const n=document.createElement("div"),e=document.createElement("h3"),t=document.createElement("button");n.classList.add("passScreen"),e.textContent=`Player ${u} attacks`,t.textContent="Ready",t.addEventListener("click",(n=>{n.stopPropagation(),B.displayBoards()})),n.appendChild(e),n.appendChild(t),c.appendChild(n)}if(!p){!1===s&&n&&c.addEventListener("click",n);const e=document.createElement("div");e.classList.add("player-board-span");const t=document.createElement("span");e.appendChild(t);for(let n=0;n<d.shipsNo;n++){const t=document.createElement("div");n<d.sunks?t.classList.add("isHit"):t.classList.add("hasShip"),e.appendChild(t)}i&&a.isPvPGamemode()?t.textContent=`Player ${o} ships:`:i&&1==o?t.textContent="Your ships:":i&&(t.textContent="Computer's ships:"),c.appendChild(e)}return c},doneFn:s,initGameboard:function(n){i=!1,a=n,o=a.handleTurn},enableTurnHandler:d,disableTurnHandler:c,enableDragDrop:function(n,o,a){e=n,t=o,r=a},disableDragDrop:p}}(),S=C,E=class{constructor(n){if("number"!=typeof n)throw"Invalid length argument";if(n<=0)throw"Invalid length argument";this.length=n,this.hits=0,this.sunk=!1}static createShips(n){const e=[];for(let t=1;t<=n;t++){const n={length:t,horizontal:0===Math.floor(2*Math.random())};e.push(n)}return e}hit(){this.hits+=1}isSunk(){return this.length===this.hits}};class L{constructor(n=5){this.shipsNo=n,this.sunks=0,this.ships=[];const e=L.SIZE;this.shotsBoard=[...Array(e)].map((()=>[...Array(e)].map((()=>null)))),this.shipsBoard=[...Array(e)].map((()=>[...Array(e)].map((()=>null))))}static get SIZE(){return 10}randomShips(){E.createShips(this.shipsNo).forEach((n=>{let e=!1;for(;!1===e;){let{row:t,col:r}=L.getValidRandomCoordinate(n.length,n.horizontal);e=this.placeShip(`${t}${r}`,n.length,n.horizontal)}}))}static getValidRandomCoordinate(n,e){const t=L.SIZE;let r=null,o=null;e?(r=t-n,o=t-1):(r=t-1,o=t-n);const a=Math.floor(Math.random()*(r+1)),i=Math.floor(Math.random()*(o+1));return console.log("GIVEN COORDINATES: "+a+i),{row:a,col:i}}static getValidCoordinates=()=>{const n=[];for(let e=0;e<L.SIZE;e++)for(let t=0;t<L.SIZE;t++)n.push(`${e}${t}`);return n};static getSorroundings(n,e,t,r){let o=null,a=null,i=null,s=null;const l=n+1,d=e+1;if(i=0===e?e:e-1,o=0===n?n:n-1,t){const t=e+r;s=t<L.SIZE?t:L.SIZE-1,a=l<L.SIZE?l:n}else{const t=n+r;a=t<L.SIZE?t:L.SIZE-1,s=d<L.SIZE?d:e}return{rowStart:o,rowEnd:a,colStart:i,colEnd:s}}static getRandomCoordinate(){const n=Math.floor(Math.random()*L.validCoordinates.length);return L.validCoordinates[n]}static validateCoordinates(n){if("string"!=typeof n)throw new Error("Invalid non string coordinates");if(!/^[0-9][0-9]$/.test(n))throw new Error("Invalid format/out of bound coordinates");return{row:parseInt(n[0],10),col:parseInt(n[1],10)}}static validateOverlapping(n,e,t,r){for(let o=0;o<r;o++){const r=!0===t?n+o:n,a=!0!==t?e+o:e;if(null!==this.shipsBoard[a][r])return console.log("Invalid overlapping ship placement"),!1}return!0}static validCoordinates=L.getValidCoordinates();static validateBounds(n,e,t,r){if(r){if(e+t>L.SIZE)return console.log("Invalid drop: Ship exceeds grid boundaries horizontally."),!1}else if(n+t>L.SIZE)return console.log("Invalid drop: Ship exceeds grid boundaries vertically."),!1;return!0}canBePlaced(n,e,t,r){if(!L.validateBounds(n,e,t,r))return!1;const{rowStart:o,rowEnd:a,colStart:i,colEnd:s}=L.getSorroundings(n,e,r,t);for(let n=o;n<=a;n++)for(let e=i;e<=s;e++)if(null!==this.shipsBoard[n][e])return!1;return!0}#n(n){return this.ships.push(new E(n))-1}areSunk(){return this.sunks===this.shipsNo}placeShip(n,e,t){if("boolean"!=typeof t)throw"Invalid orientation argument";if(this.shipsNo===this.ships.length)throw new Error("Cannot place more ships, limit has been reached");let{row:r,col:o}=L.validateCoordinates(n);if(!this.canBePlaced(r,o,e,t))return!1;const a=this.#n(e);for(let n=0;n<e;n++)this.shipsBoard[r][o]=a,t?o+=1:r+=1;return this.shipsNo!==this.ships.length||null}receiveAttack(n){const{row:e,col:t}=L.validateCoordinates(n);if(null!==this.shotsBoard[e][t])return console.log("coordinate already attacked"),null;if(null!==this.shipsBoard[e][t]){const n=this.shipsBoard[e][t],r=this.ships[n];return r.hit(),this.shotsBoard[e][t]=!0,r.isSunk()&&(this.sunks+=1),console.log("Ship hit"),!0}return this.shotsBoard[e][t]=!1,console.log("No ship at coordinate. MISS"),!1}}const k=L;class T{constructor(n){this.type="real",this.gameboard=new k(n)}}class I extends T{constructor(n){super(n),this.type="computer",this.availableCoordinates=k.getValidCoordinates()}generateRandomMove(){if(0===this.availableCoordinates.length)throw new Error("No more available moves");const n=Math.floor(Math.random()*this.availableCoordinates.length),e=this.availableCoordinates[n];return this.availableCoordinates.splice(n,1),e}}const P=function(){const n=function(n=!0){const e=document.createElement("footer");e.classList.add("boards-footer");const t=document.createElement("div");t.classList.add("footer-text");const r=document.createElement("div");if(r.classList.add("boards-btns"),!0===n){t.textContent="Select a game mode:";const n=document.createElement("button");n.classList.add("new-pvc-btn"),n.textContent="1 player";const e=document.createElement("button");e.classList.add("new-pvp-btn"),e.textContent="2 players",r.appendChild(n),r.appendChild(e)}else{const n=document.createElement("div"),e=document.createElement("div");e.classList.add("hasShip"),e.classList.add("cell-type");const o=document.createElement("span");o.textContent="Ship",n.appendChild(e),n.appendChild(o);const a=document.createElement("div"),i=document.createElement("div");i.classList.add("isHit"),i.classList.add("cell-type");const s=document.createElement("span");s.textContent="Hit",a.appendChild(i),a.appendChild(s);const l=document.createElement("div"),d=document.createElement("div");d.classList.add("isMiss"),d.classList.add("cell-type");const c=document.createElement("span");c.textContent="Miss",l.appendChild(d),l.appendChild(c),t.appendChild(n),t.appendChild(a),t.appendChild(l);const p=document.createElement("button");p.classList.add("go-back-btn"),p.textContent="Back to menu",r.appendChild(p)}return e.appendChild(t),e.appendChild(r),e};return{main:function(){const e=document.createElement("div");e.classList.add("game-container");const t=function(){const n=document.createElement("header");n.classList.add("boards-header");const e=document.createElement("h2");return e.textContent="Are you ready for the battle?",n.appendChild(e),n}(),r=function(){const n=document.createElement("div");n.classList.add("boards-container");const e=document.createElement("div");e.classList.add("player1-container");const t=document.createElement("div");return t.classList.add("player2-container"),n.appendChild(e),n.appendChild(t),n}(),o=n();return e.appendChild(t),e.appendChild(r),e.appendChild(o),e},footer:n}}(),A=function(){const n=function(n,e=!0){if(!n.parentNode.classList.contains("gameboard-col"))return;const t=n.parentNode,r=parseInt(t.dataset.rowcol[0]),o=parseInt(t.dataset.rowcol[1]),a=parseInt(n.dataset.length),i="horizontal"==n.dataset.orientation,s=n.closest(".gameboard");for(let t=0;t<a;t++){let a=null;if(0===t)a=s.children[r].children[o];else if(i){const n=o+t;if(n>=k.SIZE)return!1;a=s.children[r].children[n]}else{const n=r+t;if(n>=k.SIZE)return!1;a=s.children[n].children[o]}1==e?(a.classList.add("occupied"),a.classList.add(`by-ship-${n.id}`)):null!=a&&a.classList.contains("occupied")&&a.classList.contains(`by-ship-${n.id}`)&&(a.classList.remove("occupied"),a.classList.remove(`by-ship-${n.id}`))}},e=function(n,e,t,r,o,a){if(!k.validateBounds(n,e,t,r))return!1;const i=function(n,e,t,r,o,a){const{rowStart:i,rowEnd:s,colStart:l,colEnd:d}=k.getSorroundings(n,e,r,t);for(let n=i;n<=s;n++)for(let e=l;e<=d;e++){const t=o.children[n];if(null==t)return[!1];const r=t.children[e];if(null==r)return!1;const i=r.classList.contains(`by-ship-${a}`),s=r.classList.contains("occupied");if(s&&i)console.log("Ship overlaps itself. So it is a realocation at "+n+e);else if(s)return console.log("Ship element overlaps another ship element at "+n+e),!1}return!0}(n,e,t,r,o,a);return i},t=function(n){n.preventDefault(),n.dataTransfer.getData("ship-class")},r=function(t,r){if(t.preventDefault(),"true"!==t.dataTransfer.getData("ship-class"))return;if(!t.target.classList.contains("gameboard-col"))return;const o=t.currentTarget,a=t.dataTransfer.getData("ship-id"),i=o.dataset.rowcol,s=parseInt(t.dataTransfer.getData("length")),l="horizontal"===t.dataTransfer.getData("orientation"),d=o.closest(".gameboard"),c=(d.dataset.boardNo,function(n,t,r,o,a,i){const{row:s,col:l}=k.validateCoordinates(n);return!!e(s,l,t,r,a,i)&&o.canBePlaced(s,l,t,r)}(i,s,l,r,d,a));if(0==c)return console.log("Invalid drop: Ship placement rejected."),o.classList.add("invalid-drop"),void setTimeout((()=>{o.classList.remove("invalid-drop")}),500);console.log(`Valid drop ship of length ${s} at ${i}`),o.classList.remove("hovered");const p=document.getElementById(a);"true"===t.dataTransfer.getData("is-placed")&&n(p,!1),p.classList.add("positioned"),p.classList.remove("dragging"),o.appendChild(p),n(p,!0),null===c&&(S.disableDragDrop(),S.enableTurnHandler())},o=function(n){n.currentTarget.classList.remove("hovered")},a=function(){const t=document.querySelectorAll(".ship"),r=document.querySelector(".gameboard");r.classList.remove,t.forEach((t=>{t.parentNode.classList.contains("gameboard-col")&&n(t,!1);const o=parseInt(t.dataset.length);0===Math.floor(2*Math.random())?(t.classList.remove("flex-row"),t.classList.add("flex-col"),t.dataset.orientation="vertical"):(t.classList.remove("flex-col"),t.classList.add("flex-row"),t.dataset.orientation="horizontal");const a="horizontal"===t.dataset.orientation;let i=0;for(;;){if(i>=100)throw"Something went wrong positioning the ships";const{row:s,col:l}=k.getValidRandomCoordinate(o,a);if(1==e(s,l,o,a,r,t.id)){console.log("Dom valid?");const e=document.getElementById(t.id),o=r.children[s].children[l];e.classList.add("positioned"),e.classList.remove("dragging"),o.appendChild(e),n(e,!0);break}i++,console.log("invalid")}}))},i=function(n,e){const t=1===e?2:1,r=document.createElement("div");r.classList.add("place-ships-wrapper");const o=function(n=B.dragstart,e=B.dragend,t=B.rotateShip){const r=document.createElement("div");r.classList.add("ships-container");for(let o=0;o<3;o++){const a=o+1,i=document.createElement("div");i.id=a,i.classList.add("ship"),i.classList.add("flex-row"),i.setAttribute("draggable",!0),i.dataset.length=a,i.dataset.orientation="horizontal";for(let n=0;n<a;n++){const n=document.createElement("div");n.classList.add("ship-cell"),i.appendChild(n)}i.addEventListener("dragstart",n),i.addEventListener("dragend",e),i.addEventListener("dblclick",t),r.appendChild(i)}return r}(),i=document.createElement("button");i.textContent="Done",i.classList.add("done-btn"),i.addEventListener("click",n);const s=document.createElement("button");s.textContent="Random",s.classList.add("random-btn"),s.addEventListener("click",a);const l=document.createElement("div");l.classList.add("ships-btns"),l.appendChild(s),l.appendChild(i),r.appendChild(o),r.appendChild(l),w.render.ships(r,t)},s=function(n,e=!1,t=null){let r=null;if(null!==t){const t=new k;r=S.boardNode(n,e,t)}else r=S.boardNode(n,e);w.render.board[n](r)},l=function(n=null,e=!1){s(1,e,n),s(2,e,n)},d=function(n,e,t=null,r=!1){let o=null;o=r&&!e?"Deploy your fleet":r?`Player ${n} place your navy`:2!=t||e?1!=t||e?t?`Player ${t} emerges victorious!`:1===n?`Player ${n} launch your attack`:`Player ${n} time to attack back`:"You won! :D":"Computer wins! :/";const a=document.createElement("h2");a.textContent=o,w.render.boardsHeader(a)},c=function(n){const e=function(){const n={1:null,2:null};let e=1,t=null,r=null;const o=function(){return 1===e?2:1},a=function(){e=o()},i=function(){const r=n[2].generateRandomMove(),o=n[1].gameboard.receiveAttack(r);return o&&(e=2,!0===n[1].gameboard.areSunk()&&(t=2)),o};return{init:function(e){r=e,[n[1],n[2]]=function(){if(!0===r)return[new T(3),new T(3)];const n=new I(3);return n.gameboard.randomShips(),[new T(3),n]}()},handleTurn:function(s){if(t)return;const l=s.target.dataset.rowcol;if(!l)return;if(s.target.closest(".gameboard").dataset.boardNo==e)return void console.log("Ignored. Player click on its own board");console.log("Turn on game Instance "+e);const d=o();let c=function(e){const t=o();return n[t].gameboard.receiveAttack(e)}(l);return null===c?null:!0===c?(!0===n[d].gameboard.areSunk()&&(t=e),!0):!0!==r?(c=i(),c):(a(),a(),!1)},changeTurn:a,players:n,playAITurn:i,getTurn:function(){return e},checkWinner:function(){return t},isPvPGamemode:function(){return r},getRivalTurn:o}}();e.init(n),S.initGameboard(e),S.enableDragDrop(t,r,o);const a=e.getTurn();d(a,e.isPvPGamemode(),null,!0),s(a),i(S.doneFn,a),p()},p=function(){const n=P.footer(!1);w.render.footer(n),w.initHandlers.goBack(h)},u=function(){w.initHandlers.gamemodes(c)},h=function(){const n=P.main();w.render.mainPage(n),w.referenceDom(),u(),l(!0)};return{initGame:c,displayBoard:s,displayBoards:l,displayPassScreen:function(){const n=!0;s(1,n),s(2,n)},displayShips:i,displayWinner:function(n,e){console.log("display winner fn");const t=document.createElement("dialog"),r=document.createElement("h2");r.textContent=e||2!==n?e||1!==n?`Player ${n} wins!`:"You won!":"Computer wins! :(";const o=document.createElement("button");o.textContent="Ok",o.autofocus=!0,o.addEventListener("click",(n=>{t.close(),t.parentNode.removeChild(t)})),t.appendChild(r),t.appendChild(o),w.render.dialog(t)},dragstart:function(n){const e=n.currentTarget,t=e.parentNode.classList.contains("gameboard-col");n.dataTransfer.setData("ship-id",e.id),n.dataTransfer.setData("ship-class",e.classList.contains("ship")),n.dataTransfer.setData("length",e.dataset.length),n.dataTransfer.setData("orientation",e.dataset.orientation),n.dataTransfer.setData("is-placed",t),n.dataTransfer.setDragImage(n.currentTarget,10,25),e.classList.add("dragging"),console.log(`Dragging ship of length: ${e.dataset.length}`),console.log(`Dragging ship of orientation: ${e.dataset.orientation}`)},dragend:function(n){n.currentTarget.classList.remove("dragging")},drop:r,dragover:t,dragleave:o,rotateShip:function(t){const r=t.currentTarget;if(r.parentNode.classList.contains("gameboard-col")){const t=parseInt(r.parentNode.dataset.rowcol[0]),o=parseInt(r.parentNode.dataset.rowcol[1]),a=parseInt(r.dataset.length),i="horizontal"!==r.dataset.orientation,s=r.closest(".gameboard"),l=r.id;if(!e(t,o,a,i,s,l))return void console.log("Cannot rotate as it overlaps other ships");n(r,!1)}!0===r.classList.contains("flex-row")?(r.classList.remove("flex-row"),r.classList.add("flex-col"),r.dataset.orientation="vertical"):(r.classList.remove("flex-col"),r.classList.add("flex-row"),r.dataset.orientation="horizontal"),n(r,!0)},testPlaceShips:function(n){n.gameboard.placeShip("00",1,!0),n.gameboard.placeShip("01",2,!0),n.gameboard.placeShip("10",2,!1)},initDomHandlers:u,displayHeader:d,mainPage:h}}(),B=A;B.mainPage()})();